<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>5 in a row</title>
	<link rel="stylesheet" href="main.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

<h1 class="result"> Grid Test </h1>
</body>

</html>

<script>

var mousedown = false;
var ipos;
var ibgpos;

$('html').on('mousedown', startDragMouse).on('mouseup mouseleave', function() {
	mousedown = false;
});

$('html').on('mousemove', function(e) {
	if(mousedown) {dragMouse(e)}
});

window.addEventListener("touchmove", dragFinger, {passive: false} );
window.addEventListener("touchstart", startDragFinger, {passive: false} );

function getIBGpos() {
	let ibgposString = ($('html').css("background-position")).split(',')[0].split(" ")
	let pos = [Number(ibgposString[0].split("p")[0]), Number(ibgposString[1].split("p")[0])]
	return pos;
}


function startDragFinger(e) {
	e.preventDefault();
	ibgpos = getIBGpos();
	let pos = e.changedTouches;
	ipos = [pos[0].pageX, pos[0].pageY]
}

function dragFinger(e) {
	e.preventDefault()
	let pos = e.changedTouches
	var x = (ibgpos[0] + pos[0].pageX - ipos[0])
	var y = (ibgpos[1] + pos[0].pageY - ipos[1])
	moveGrid(x,y)
	updateText(Math.floor(x),Math.floor(y))
}

function startDragMouse(e) {
	mousedown = true;
	ibgpos = getIBGpos();
	ipos = [e.pageX, e.pageY]
}

function dragMouse(e) {
	var x = (ibgpos[0] + e.pageX - ipos[0])
	var y = (ibgpos[1] + e.pageY - ipos[1])
	moveGrid(x,y)
	updateText(Math.floor(x),Math.floor(y))
}

function moveGrid(x,y) {
	$('html').css("background-position", x + "px " + y + "px");
}
function updateText(one,two) {
	$('h1.result').html("(" + one + ", " + two + ")");
}
</script>
